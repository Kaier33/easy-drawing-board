<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      * {
        padding: 0;
        margin: 0;
      }
      body {
        padding: 0 10px;
      }
      .btn {
        outline-style: none;
        margin: 10px;
        color: #fff;
        padding: 10px 20px;
        height: 40px;
        font-size: 20px;
        line-height: 20px;
        text-align: center;
        border-radius: 10px;
        background-color: skyblue;
      }
      .container,.container2{
        display: inline-block;
        position: relative;
        top: 0;
        z-index: 100;
        border: 5px solid #eee;
        width: 500px;
        height: 500px;
      }
      .container2 {
        z-index: 200;
      }
      .eraserSize,
      .arrowSize,
      .fontSize,
      .textLineHeight,
      .currLineWidth {
        display: inline-block;
        min-width: 40px !important;
      }
    </style>
    <script src="../dist/easy-drawing-board.js"></script>
  </head>
  <body>
    <div id="operations">
      <!-- id 关联到事件绑定 -->
      <button class="btn" id="clear">clear</button>
      <button class="btn" id="eraser">橡皮擦</button>
      <button class="btn" id="pencil">铅笔</button>
      <button class="btn" id="straightLine">直线</button>
      <button class="btn" id="rect">矩形</button>
      <button class="btn" id="circle">圆形</button>
      <button class="btn" id="arrow">箭头</button>
      <button class="btn" id="text">文字</button>
    </div>
    <div>
      <label>线条颜色 <input onchange="colorChange(event)" id="color" type="color" value="#f00f00"></label>
      &nbsp;&nbsp;&nbsp;
      <label>线条粗细: <i class="currLineWidth">1</i><input type="range" onchange="rangeChange(event)" min="1" max="50" value="1"></label>
      <label>箭头大小: <i class="arrowSize">15</i><input type="range" onchange="rangeChange4(event)" min="10" max="30" value="15"></label>
      <label>橡皮擦大小: <i class="eraserSize">10</i><input type="range" onchange="rangeChange5(event)" min="1" max="30" value="10"></label>
    </div>
    <div>
      <label>文字颜色 <input onchange="colorChange2(event)" id="textColor" type="color" value="#f00f00"></label>
      &nbsp;&nbsp;&nbsp;
      <label>文字大小: <i class="fontSize">16</i><input type="range" onchange="rangeChange2(event)" min="12" max="22" value="16"></label>
      <label>文字行高: <i class="textLineHeight">20</i><input type="range" onchange="rangeChange3(event)" min="16" max="30" value="20"></label>
    </div>
    <div>
      <label>背景颜色 <input onchange="colorChange3(event)" id="bgColor" type="color" value="#ffffff"></label>
    </div>
    <div>
      <button class="btn" onclick="generateBase64()">export base64 data</button>
      <button class="btn" onclick="saveImg()">save</button>
    </div>
    <p>左图: 是纯色背景; 右图: 用于图片的批注</p>
    <br />
    <div class="container2"></div>
    <div class="container"></div>
  </body>
  <script>
    let draw = null, draw2 = null;
    function rangeChange(e) {
      let dom = document.getElementsByClassName('currLineWidth')[0];
      dom.innerHTML = e.target.value
      draw && draw.config('lineWidth', e.target.value)
      draw2 && draw2.config('lineWidth', e.target.value)
    }
    function rangeChange2(e) {
      let dom = document.getElementsByClassName('fontSize')[0];
      dom.innerHTML = e.target.value
      draw && draw.config('textFontSize', e.target.value)
      draw2 && draw2.config('textFontSize', e.target.value)
    }
    function rangeChange3(e) {
      let dom = document.getElementsByClassName('textLineHeight')[0];
      dom.innerHTML = e.target.value
      draw && draw.config('textLineHeight', e.target.value)
      draw2 && draw2.config('textLineHeight', e.target.value)
    }
    function rangeChange4(e) {
      let dom = document.getElementsByClassName('arrowSize')[0];
      dom.innerHTML = e.target.value
      draw && draw.config('arrowSize', e.target.value)
      draw2 && draw2.config('arrowSize', e.target.value)
    }
    function rangeChange5(e) {
      let dom = document.getElementsByClassName('eraserSize')[0];
      dom.innerHTML = e.target.value
      draw && draw.config('eraserSize', e.target.value)
      draw2 && draw2.config('eraserSize', e.target.value)
    }
    function colorChange(e) {
      let dom = document.getElementById('color');
      draw && draw.config('lineColor', e.target.value)
      draw2 && draw2.config('lineColor', e.target.value)
    }

    function colorChange2(e) {
      let dom = document.getElementById('textColor');
      draw && draw.config('textColor', e.target.value)
    }

    function colorChange3(e) {
      let dom = document.getElementById('bgColor');
      draw2 && draw2.config('canvasBgColor', e.target.value)
    }


    function generateBase64() {
      draw.generateBase64().then(res => {
        console.log('data1::', res)
      })
      draw2.generateBase64().then(res => {
        console.log('data2::', res)
      })
      alert('已输出至于 控制台')
    }

    function saveImg() {
      draw && draw.saveImg()
      draw2 && draw2.saveImg()
    }

    window.onload = function () {
      const container = document.getElementsByClassName('container')[0];
      const operations = document.getElementById('operations');
      operations.addEventListener('click', function(e) {
        let mode = e.target.id
        if (mode === 'clear') {
          draw.clear()
          draw2.clear()
        } else {
          draw.setMode(mode)
          draw2.setMode(mode)
        }
      })
      const options = {
        container,
        bgImg: 'http://image.kaier33.top/ori.jpg'
      };
      draw = new EasyDrawingBoard(options);

      const container2 = document.getElementsByClassName('container2')[0];
      draw2 = new EasyDrawingBoard({container: container2});
    };
  </script>
  
</html>
